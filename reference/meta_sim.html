<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Metapopulation Respiratory Virus Model Simulator — meta_sim • MetaRVM</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Metapopulation Respiratory Virus Model Simulator — meta_sim"><meta name="description" content="The core simulation engine that implements a stochastic compartmental SEIRD
(Susceptible-Exposed-Infected-Recovered-Dead) model for respiratory virus
epidemics across multiple demographic subpopulations. The function compiles
and executes an ODIN-based differential equation model with time-varying
contact patterns, vaccination dynamics, and complex disease progression pathways."><meta property="og:description" content="The core simulation engine that implements a stochastic compartmental SEIRD
(Susceptible-Exposed-Infected-Recovered-Dead) model for respiratory virus
epidemics across multiple demographic subpopulations. The function compiles
and executes an ODIN-based differential equation model with time-varying
contact patterns, vaccination dynamics, and complex disease progression pathways."><meta property="og:image" content="https://RESUME-Epi.github.io/MetaRVM/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MetaRVM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="MetaRVM"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/RESUME-Epi/MetaRVM" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Metapopulation Respiratory Virus Model Simulator</h1>
      <small class="dont-index">Source: <a href="https://github.com/RESUME-Epi/MetaRVM/blob/main/R/metaODIN.R" class="external-link"><code>R/metaODIN.R</code></a></small>
      <div class="d-none name"><code>meta_sim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The core simulation engine that implements a stochastic compartmental SEIRD
(Susceptible-Exposed-Infected-Recovered-Dead) model for respiratory virus
epidemics across multiple demographic subpopulations. The function compiles
and executes an ODIN-based differential equation model with time-varying
contact patterns, vaccination dynamics, and complex disease progression pathways.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">meta_sim</span><span class="op">(</span></span>
<span>  <span class="va">N_pop</span>,</span>
<span>  <span class="va">ts</span>,</span>
<span>  <span class="va">tv</span>,</span>
<span>  <span class="va">S0</span>,</span>
<span>  <span class="va">I0</span>,</span>
<span>  <span class="va">P0</span>,</span>
<span>  <span class="va">R0</span>,</span>
<span>  H0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">N_pop</span><span class="op">)</span>,</span>
<span>  D0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">N_pop</span><span class="op">)</span>,</span>
<span>  Ia0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">N_pop</span><span class="op">)</span>,</span>
<span>  Ip0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">N_pop</span><span class="op">)</span>,</span>
<span>  E0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">N_pop</span><span class="op">)</span>,</span>
<span>  <span class="va">m_weekday_day</span>,</span>
<span>  <span class="va">m_weekday_night</span>,</span>
<span>  <span class="va">m_weekend_day</span>,</span>
<span>  <span class="va">m_weekend_night</span>,</span>
<span>  <span class="va">delta_t</span>,</span>
<span>  <span class="va">vac_mat</span>,</span>
<span>  <span class="va">dv</span>,</span>
<span>  <span class="va">de</span>,</span>
<span>  <span class="va">pea</span>,</span>
<span>  <span class="va">dp</span>,</span>
<span>  <span class="va">da</span>,</span>
<span>  <span class="va">ds</span>,</span>
<span>  <span class="va">psr</span>,</span>
<span>  <span class="va">dh</span>,</span>
<span>  <span class="va">phr</span>,</span>
<span>  <span class="va">dr</span>,</span>
<span>  <span class="va">ve</span>,</span>
<span>  <span class="va">nsteps</span>,</span>
<span>  is.stoch <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  do_chk <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  chk_time_steps <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chk_file_names <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n-pop">N_pop<a class="anchor" aria-label="anchor" href="#arg-n-pop"></a></dt>
<dd><p>Integer. Number of demographic subpopulations in the model</p></dd>


<dt id="arg-ts">ts<a class="anchor" aria-label="anchor" href="#arg-ts"></a></dt>
<dd><p>Numeric vector or scalar. Transmission rate for symptomatic individuals
in susceptible population. If scalar, applied to all subpopulations</p></dd>


<dt id="arg-tv">tv<a class="anchor" aria-label="anchor" href="#arg-tv"></a></dt>
<dd><p>Numeric vector or scalar. Transmission rate for symptomatic individuals
in vaccinated population. If scalar, applied to all subpopulations</p></dd>


<dt id="arg-s-">S0<a class="anchor" aria-label="anchor" href="#arg-s-"></a></dt>
<dd><p>Numeric vector of length N_pop. Initial number of susceptible individuals
in each subpopulation</p></dd>


<dt id="arg-i-">I0<a class="anchor" aria-label="anchor" href="#arg-i-"></a></dt>
<dd><p>Numeric vector of length N_pop. Initial number of symptomatic infected
individuals in each subpopulation</p></dd>


<dt id="arg-p-">P0<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>Numeric vector of length N_pop. Total population sizes for each subpopulation</p></dd>


<dt id="arg-r-">R0<a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>Numeric vector of length N_pop. Initial number of recovered individuals
in each subpopulation</p></dd>


<dt id="arg-h-">H0<a class="anchor" aria-label="anchor" href="#arg-h-"></a></dt>
<dd><p>Numeric vector of length N_pop. Initial number of hospitalized individuals
in each subpopulation (default: rep(0, N_pop))</p></dd>


<dt id="arg-d-">D0<a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>Numeric vector of length N_pop. Initial number of deceased individuals
in each subpopulation (default: rep(0, N_pop))</p></dd>


<dt id="arg-ia-">Ia0<a class="anchor" aria-label="anchor" href="#arg-ia-"></a></dt>
<dd><p>Numeric vector of length N_pop. Initial number of asymptomatic infected
individuals in each subpopulation (default: rep(0, N_pop))</p></dd>


<dt id="arg-ip-">Ip0<a class="anchor" aria-label="anchor" href="#arg-ip-"></a></dt>
<dd><p>Numeric vector of length N_pop. Initial number of presymptomatic infected
individuals in each subpopulation (default: rep(0, N_pop))</p></dd>


<dt id="arg-e-">E0<a class="anchor" aria-label="anchor" href="#arg-e-"></a></dt>
<dd><p>Numeric vector of length N_pop. Initial number of exposed individuals
in each subpopulation (default: rep(0, N_pop))</p></dd>


<dt id="arg-m-weekday-day">m_weekday_day<a class="anchor" aria-label="anchor" href="#arg-m-weekday-day"></a></dt>
<dd><p>Numeric matrix (N_pop × N_pop). Contact mixing matrix for
weekday daytime (6 AM - 6 PM) interactions</p></dd>


<dt id="arg-m-weekday-night">m_weekday_night<a class="anchor" aria-label="anchor" href="#arg-m-weekday-night"></a></dt>
<dd><p>Numeric matrix (N_pop × N_pop). Contact mixing matrix for
weekday nighttime (6 PM - 6 AM) interactions</p></dd>


<dt id="arg-m-weekend-day">m_weekend_day<a class="anchor" aria-label="anchor" href="#arg-m-weekend-day"></a></dt>
<dd><p>Numeric matrix (N_pop × N_pop). Contact mixing matrix for
weekend daytime (6 AM - 6 PM) interactions</p></dd>


<dt id="arg-m-weekend-night">m_weekend_night<a class="anchor" aria-label="anchor" href="#arg-m-weekend-night"></a></dt>
<dd><p>Numeric matrix (N_pop × N_pop). Contact mixing matrix for
weekend nighttime (6 PM - 6 AM) interactions</p></dd>


<dt id="arg-delta-t">delta_t<a class="anchor" aria-label="anchor" href="#arg-delta-t"></a></dt>
<dd><p>Positive numeric. Discrete time increment in days (typically 0.5)</p></dd>


<dt id="arg-vac-mat">vac_mat<a class="anchor" aria-label="anchor" href="#arg-vac-mat"></a></dt>
<dd><p>Numeric matrix. Vaccination schedule with dimensions (nsteps × (1 + N_pop)).
First column contains time indices, remaining columns contain vaccination counts
for each subpopulation at each time step</p></dd>


<dt id="arg-dv">dv<a class="anchor" aria-label="anchor" href="#arg-dv"></a></dt>
<dd><p>Numeric vector or scalar. Mean duration (days) in vaccinated state before
immunity waning. If scalar, applied to all subpopulations</p></dd>


<dt id="arg-de">de<a class="anchor" aria-label="anchor" href="#arg-de"></a></dt>
<dd><p>Numeric vector or scalar. Mean duration (days) in exposed state.
If scalar, applied to all subpopulations</p></dd>


<dt id="arg-pea">pea<a class="anchor" aria-label="anchor" href="#arg-pea"></a></dt>
<dd><p>Numeric vector or scalar. Proportion of exposed individuals becoming
asymptomatic infectious (vs. presymptomatic). Range: (0,1).
If scalar, applied to all subpopulations</p></dd>


<dt id="arg-dp">dp<a class="anchor" aria-label="anchor" href="#arg-dp"></a></dt>
<dd><p>Numeric vector or scalar. Mean duration (days) in presymptomatic
infectious state. If scalar, applied to all subpopulations</p></dd>


<dt id="arg-da">da<a class="anchor" aria-label="anchor" href="#arg-da"></a></dt>
<dd><p>Numeric vector or scalar. Mean duration (days) in asymptomatic
infectious state. If scalar, applied to all subpopulations</p></dd>


<dt id="arg-ds">ds<a class="anchor" aria-label="anchor" href="#arg-ds"></a></dt>
<dd><p>Numeric vector or scalar. Mean duration (days) in symptomatic
infectious state. If scalar, applied to all subpopulations</p></dd>


<dt id="arg-psr">psr<a class="anchor" aria-label="anchor" href="#arg-psr"></a></dt>
<dd><p>Numeric vector or scalar. Proportion of symptomatic individuals
recovering directly (vs. hospitalization). Range: (0,1).
If scalar, applied to all subpopulations</p></dd>


<dt id="arg-dh">dh<a class="anchor" aria-label="anchor" href="#arg-dh"></a></dt>
<dd><p>Numeric vector or scalar. Mean duration (days) in hospitalized state.
If scalar, applied to all subpopulations</p></dd>


<dt id="arg-phr">phr<a class="anchor" aria-label="anchor" href="#arg-phr"></a></dt>
<dd><p>Numeric vector or scalar. Proportion of hospitalized individuals
recovering (vs. death). Range: (0,1). If scalar, applied to all subpopulations</p></dd>


<dt id="arg-dr">dr<a class="anchor" aria-label="anchor" href="#arg-dr"></a></dt>
<dd><p>Numeric vector or scalar. Mean duration (days) of immunity in
recovered state. If scalar, applied to all subpopulations</p></dd>


<dt id="arg-ve">ve<a class="anchor" aria-label="anchor" href="#arg-ve"></a></dt>
<dd><p>Numeric vector or scalar. Vaccine effectiveness (proportion).
Range: 0,1. If scalar, applied to all subpopulations</p></dd>


<dt id="arg-nsteps">nsteps<a class="anchor" aria-label="anchor" href="#arg-nsteps"></a></dt>
<dd><p>Integer. Total number of discrete time evolution steps in simulation</p></dd>


<dt id="arg-is-stoch">is.stoch<a class="anchor" aria-label="anchor" href="#arg-is-stoch"></a></dt>
<dd><p>Logical. Whether to run stochastic simulation (TRUE) or
deterministic simulation (FALSE). Default: FALSE</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Integer or NULL. Random seed for reproducibility. Only used when
is.stoch = TRUE. Default: NULL</p></dd>


<dt id="arg-do-chk">do_chk<a class="anchor" aria-label="anchor" href="#arg-do-chk"></a></dt>
<dd><p>Logical. Whether to save model checkpoint at simulation end.
Default: FALSE</p></dd>


<dt id="arg-chk-time-steps">chk_time_steps<a class="anchor" aria-label="anchor" href="#arg-chk-time-steps"></a></dt>
<dd><p>Integer vector or NULL. Time steps at which to save checkpoints.</p></dd>


<dt id="arg-chk-file-names">chk_file_names<a class="anchor" aria-label="anchor" href="#arg-chk-file-names"></a></dt>
<dd><p>List of character vectors or NULL. File names for checkpoints.
Each element of the list corresponds to a time step in <code>chk_time_steps</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a data.table with the following structure:</p><dl><dt>step</dt>
<dd><p>Integer time step index (0 to nsteps)</p></dd>

<dt>time</dt>
<dd><p>Continuous simulation time (step × delta_t)</p></dd>

<dt>disease_state</dt>
<dd><p>Character vector of compartment names</p></dd>

<dt>population_id</dt>
<dd><p>Character vector of subpopulation identifiers</p></dd>

<dt>value</dt>
<dd><p>Numeric values representing population counts in each compartment</p></dd>


</dl><p>Available disease states in output:</p><ul><li><p>Core compartments: S, E, I_presymp, I_asymp, I_symp, H, R, D, V, P</p></li>
<li><p>Derived outputs: I_all (total infectious), cum_V (cumulative vaccinations)</p></li>
<li><p>Transition flows: n_SE, n_EI, n_HR, n_HD, etc. (new infections, hospitalizations, deaths)</p></li>
<li><p>Debug outputs: p_SE, p_VE, I_eff (probabilities and effective populations)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The model implements a complex epidemiological framework with the following features:</p>
<p><strong>Compartmental Structure:</strong></p><ul><li><p><strong>S</strong>: Susceptible individuals</p></li>
<li><p><strong>E</strong>: Exposed (incubating) individuals</p></li>
<li><p><strong>I_presymp</strong>: Presymptomatic infectious individuals</p></li>
<li><p><strong>I_asymp</strong>: Asymptomatic infectious individuals</p></li>
<li><p><strong>I_symp</strong>: Symptomatic infectious individuals</p></li>
<li><p><strong>H</strong>: Hospitalized individuals</p></li>
<li><p><strong>R</strong>: Recovered individuals</p></li>
<li><p><strong>D</strong>: Deceased individuals</p></li>
<li><p><strong>V</strong>: Vaccinated individuals</p></li>
<li><p><strong>P</strong>: Total living population (excludes deaths)</p></li>
</ul><p><strong>Disease Progression Pathways:</strong></p><ol><li><p><strong>S → E</strong>: Exposure through contact with infectious individuals</p></li>
<li><p><strong>E → I_asymp/I_presymp</strong>: Progression to infectious states (proportion pea)</p></li>
<li><p><strong>I_presymp → I_symp</strong>: Development of symptoms</p></li>
<li><p><strong>I_asymp → R</strong>: Direct recovery from asymptomatic state</p></li>
<li><p><strong>I_symp → R/H</strong>: Recovery or hospitalization (proportion psr)</p></li>
<li><p><strong>H → R/D</strong>: Hospital discharge or death (proportion phr)</p></li>
<li><p><strong>R → S</strong>: Loss of immunity</p></li>
<li><p><strong>S → V</strong>: Vaccination</p></li>
<li><p><strong>V → S/E</strong>: Vaccine waning or breakthrough infection</p></li>
</ol><p><strong>Mixing Patterns:</strong>
Contact patterns vary by:</p><ul><li><p>Day of week: Weekday vs. weekend patterns</p></li>
<li><p>Time of day: Day (6 AM - 6 PM) vs. night (6 PM - 6 AM) patterns</p></li>
<li><p>Each pattern specified by N_pop × N_pop contact matrix</p></li>
</ul><p><strong>Force of Infection:</strong>
Transmission occurs through contact between susceptible/vaccinated individuals and
all infectious compartments (I_presymp + I_asymp + I_symp), modified by:</p><ul><li><p>Population-specific transmission rates (ts, tv)</p></li>
<li><p>Time-varying contact patterns</p></li>
<li><p>Vaccine effectiveness for breakthrough infections</p></li>
</ul><p><strong>Stochastic vs. Deterministic Mode:</strong></p><ul><li><p><strong>Deterministic</strong>: Uses exact differential equations</p></li>
<li><p><strong>Stochastic</strong>: Adds demographic stochasticity via binomial draws</p></li>
</ul><p><strong>Vaccination Implementation:</strong>
Vaccination is implemented as time-varying input with:</p><ul><li><p>Scheduled vaccination counts per time step and subpopulation</p></li>
<li><p>Vaccine effectiveness reducing infection probability</p></li>
<li><p>Waning immunity returning individuals to susceptible state</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="parameter-scaling">Parameter Scaling<a class="anchor" aria-label="anchor" href="#parameter-scaling"></a></h2>


<p>All duration parameters are automatically converted to rates (1/duration).
Scalar parameters are automatically expanded to vectors of length N_pop.
This allows flexible specification of homogeneous or heterogeneous parameters.</p>
    </div>
    <div class="section level2">
    <h2 id="checkpointing">Checkpointing<a class="anchor" aria-label="anchor" href="#checkpointing"></a></h2>


<p>When do_chk = TRUE, the function saves a checkpoint file containing:</p><ul><li><p>Final compartment states for simulation continuation</p></li>
<li><p>All model parameters for reproducibility</p></li>
<li><p>Vaccination schedule data</p></li>
<li><p>Population structure information</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="performance-considerations">Performance Considerations<a class="anchor" aria-label="anchor" href="#performance-considerations"></a></h2>


<ul><li><p>Runtime scales approximately as O(N_pop² × nsteps)</p></li>
<li><p>Memory usage increases with output frequency and population complexity</p></li>
<li><p>Stochastic mode adds computational overhead for random number generation</p></li>
<li><p>Large contact matrices (high N_pop) significantly impact performance</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>ODIN package: <a href="https://mrc-ide.github.io/odin/" class="external-link">https://mrc-ide.github.io/odin/</a></p></li>
<li><p>Fadikar, A., et al. "Developing and deploying a use-inspired metapopulation modeling framework for detailed tracking of stratified health outcomes"</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="metaRVM.html">metaRVM</a></code> for high-level simulation interface with configuration files
<code><a href="parse_config.html">parse_config</a></code> for configuration file processing
<code><a href="format_metarvm_output.html">format_metarvm_output</a></code> for output formatting with demographics</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Arindam Fadikar, Charles Macal, Ignacio Martinez-Moyano, Jonathan Ozik</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic deterministic simulation</span></span></span>
<span class="r-in"><span><span class="va">N_pop</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">nsteps</span> <span class="op">&lt;-</span> <span class="fl">400</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Initialize populations</span></span></span>
<span class="r-in"><span><span class="va">S0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="va">N_pop</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">I0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">N_pop</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P0</span> <span class="op">&lt;-</span> <span class="va">S0</span> <span class="op">+</span> <span class="va">I0</span></span></span>
<span class="r-in"><span><span class="va">R0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">N_pop</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Contact matrices (simplified - identity matrices)</span></span></span>
<span class="r-in"><span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">N_pop</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic vaccination schedule (no vaccination)</span></span></span>
<span class="r-in"><span><span class="va">vac_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">nsteps</span> <span class="op">+</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="va">N_pop</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vac_mat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">nsteps</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run simulation</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">meta_sim</span><span class="op">(</span></span></span>
<span class="r-in"><span>  N_pop <span class="op">=</span> <span class="va">N_pop</span>,</span></span>
<span class="r-in"><span>  ts <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  tv <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  S0 <span class="op">=</span> <span class="va">S0</span>,</span></span>
<span class="r-in"><span>  I0 <span class="op">=</span> <span class="va">I0</span>,</span></span>
<span class="r-in"><span>  P0 <span class="op">=</span> <span class="va">P0</span>,</span></span>
<span class="r-in"><span>  R0 <span class="op">=</span> <span class="va">R0</span>,</span></span>
<span class="r-in"><span>  m_weekday_day <span class="op">=</span> <span class="va">contact_matrix</span>,</span></span>
<span class="r-in"><span>  m_weekday_night <span class="op">=</span> <span class="va">contact_matrix</span> <span class="op">*</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  m_weekend_day <span class="op">=</span> <span class="va">contact_matrix</span> <span class="op">*</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>  m_weekend_night <span class="op">=</span> <span class="va">contact_matrix</span> <span class="op">*</span> <span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>  delta_t <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  vac_mat <span class="op">=</span> <span class="va">vac_mat</span>,</span></span>
<span class="r-in"><span>  dv <span class="op">=</span> <span class="fl">365</span>,</span></span>
<span class="r-in"><span>  de <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  pea <span class="op">=</span> <span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>  dp <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  da <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  ds <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  psr <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>  dh <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  phr <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>  dr <span class="op">=</span> <span class="fl">180</span>,</span></span>
<span class="r-in"><span>  ve <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>  nsteps <span class="op">=</span> <span class="va">nsteps</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stochastic simulation with checkpointing</span></span></span>
<span class="r-in"><span><span class="va">results_stoch</span> <span class="op">&lt;-</span> <span class="fu">meta_sim</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="co"># ... same parameters as above ...</span></span></span>
<span class="r-in"><span>  is.stoch <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  seed <span class="op">=</span> <span class="fl">12345</span>,</span></span>
<span class="r-in"><span>  do_chk <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  chk_file_name <span class="op">=</span> <span class="st">"simulation_checkpoint.rds"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arindam Fadikar, Charles Macal.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

