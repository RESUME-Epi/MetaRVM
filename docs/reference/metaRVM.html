<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run MetaRVM Epidemic Simulation — metaRVM • MetaRVM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run MetaRVM Epidemic Simulation — metaRVM"><meta name="description" content="Executes a meta-population compartmental epidemic model simulation using specified
configuration parameters. The function runs multiple simulation instances with
stochastic parameter variations and returns formatted results with calendar dates
and demographic attributes for comprehensive analysis and visualization."><meta property="og:description" content="Executes a meta-population compartmental epidemic model simulation using specified
configuration parameters. The function runs multiple simulation instances with
stochastic parameter variations and returns formatted results with calendar dates
and demographic attributes for comprehensive analysis and visualization."><meta property="og:image" content="https://RESUME-Epi.github.io/MetaRVM/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MetaRVM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="MetaRVM"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/RESUME-Epi/MetaRVM" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Run MetaRVM Epidemic Simulation</h1>
      <small class="dont-index">Source: <a href="https://github.com/RESUME-Epi/MetaRVM/blob/HEAD/R/metaRVM.R" class="external-link"><code>R/metaRVM.R</code></a></small>
      <div class="d-none name"><code>metaRVM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Executes a meta-population compartmental epidemic model simulation using specified
configuration parameters. The function runs multiple simulation instances with
stochastic parameter variations and returns formatted results with calendar dates
and demographic attributes for comprehensive analysis and visualization.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">metaRVM</span><span class="op">(</span><span class="va">config_input</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-config-input">config_input<a class="anchor" aria-label="anchor" href="#arg-config-input"></a></dt>
<dd><p>Configuration input in one of three formats:</p><ul><li><p>Character string: File path to YAML configuration file</p></li>
<li><p>MetaRVMConfig object: Pre-initialized configuration object</p></li>
<li><p>Named list: Parsed configuration data from <code><a href="parse_config.html">parse_config</a></code></p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a <code><a href="MetaRVMResults.html">MetaRVMResults</a></code> object containing:</p><dl><dt>results</dt>
<dd><p>Formatted data.table with columns:</p></dd>


 <code>date</code>: Calendar date (Date class)
 <code>age</code>: Age category (e.g., "0-4", "5-11", "18-49")
 <code>race</code>: Race/ethnicity category
 <code>zone</code>: Geographic zone identifier
 <code>disease_state</code>: Compartment name (S, E, I_asymp, H, etc.)
 <code>value</code>: Population count in compartment
 <code>instance</code>: Simulation instance number

<dt>config</dt>
<dd><p>Original MetaRVMConfig object</p></dd>

<dt>run_info</dt>
<dd><p>Simulation metadata including date range, instance count</p></dd>


</dl><p>The returned object supports method chaining for analysis:</p><ul><li><p><code>subset_data()</code>: Filter by demographics, disease states, dates</p></li>
<li><p><code>summarize()</code>: Aggregate across demographic categories with statistics</p></li>
<li><p><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>: Create time series visualizations (via method chaining)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The MetaRVM simulation implements a meta-population SEIRD (Susceptible-Exposed-Infected-Recovered-Dead)
compartmental model with additional complexity for asymptomatic and presymptomatic infections,
hospitalization states, and vaccination dynamics. The model accounts for:</p>
<p><strong>Compartmental Structure:</strong></p><ul><li><p><strong>S</strong>: Susceptible individuals</p></li>
<li><p><strong>E</strong>: Exposed (incubating) individuals</p></li>
<li><p><strong>I_asymp</strong>: Asymptomatic infectious individuals</p></li>
<li><p><strong>I_presymp</strong>: Presymptomatic infectious individuals</p></li>
<li><p><strong>I_symp</strong>: Symptomatic infectious individuals</p></li>
<li><p><strong>H</strong>: Hospitalized individuals</p></li>
<li><p><strong>R</strong>: Recovered individuals</p></li>
<li><p><strong>D</strong>: Dead individuals</p></li>
<li><p><strong>P</strong>: Protected/vaccinated individuals</p></li>
</ul><p><strong>Model Features:</strong></p><ul><li><p>Multiple population groups with demographic stratification (age, race, geography)</p></li>
<li><p>Time-varying contact patterns (weekday/weekend, day/night mixing matrices)</p></li>
<li><p>Stochastic parameter variations across simulation instances</p></li>
<li><p>Vaccination schedules with time-varying administration</p></li>
<li><p>Checkpointing capability for long simulations</p></li>
</ul><p><strong>Disease Parameters:</strong>
The model uses the following key parameters (can be stochastic across instances):</p><ul><li><p><code>ts</code>: Transmission rate for symptomatic individuals</p></li>
<li><p><code>tv</code>: Transmission rate for vaccinated individuals</p></li>
<li><p><code>ve</code>: Vaccine effectiveness</p></li>
<li><p><code>de, dp, da, ds, dh, dr</code>: Duration parameters for disease states</p></li>
<li><p><code>pea, psr, phr</code>: Probability parameters for state transitions</p></li>
</ul><p><strong>Simulation Process:</strong>
For each simulation instance, the function:</p><ol><li><p>Initializes population compartments from configuration</p></li>
<li><p>Applies instance-specific stochastic parameter values</p></li>
<li><p>Runs the ODE solver (<code>meta_sim</code>) with specified time steps</p></li>
<li><p>Collects output for all time points and populations</p></li>
<li><p>Combines results across all instances</p></li>
<li><p>Formats output with calendar dates and demographic information</p></li>
<li><p>Returns structured MetaRVMResults object for analysis</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="configuration-requirements">Configuration Requirements<a class="anchor" aria-label="anchor" href="#configuration-requirements"></a></h2>


<p>The configuration must include:</p><ul><li><p><strong>Population data</strong>: Initial compartment values, demographic mapping</p></li>
<li><p><strong>Disease parameters</strong>: Transmission rates, durations, probabilities</p></li>
<li><p><strong>Contact matrices</strong>: Weekday/weekend and day/night mixing patterns</p></li>
<li><p><strong>Simulation settings</strong>: Start date, length, number of instances</p></li>
<li><p><strong>Vaccination schedule</strong>: Time-varying vaccination rates (optional)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="performance-notes">Performance Notes<a class="anchor" aria-label="anchor" href="#performance-notes"></a></h2>


<ul><li><p>Simulation time scales with <code>nsim × nsteps × N_pop</code></p></li>
<li><p>Large population numbers or long time periods may require substantial memory</p></li>
<li><p>Consider checkpointing (<code>do_chk = TRUE</code>) for long simulations</p></li>
<li><p>Output formatting adds overhead but provides analysis-ready data structure</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="error-handling">Error Handling<a class="anchor" aria-label="anchor" href="#error-handling"></a></h2>


<p>The function validates input configuration and will stop with informative messages for:</p><ul><li><p>Invalid <code>config_input</code> type or format</p></li>
<li><p>Missing required configuration parameters</p></li>
<li><p>Inconsistent population or parameter dimensions</p></li>
<li><p>File access issues for configuration or checkpoint files</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fadikar, A., et al. "Developing and deploying a use-inspired metapopulation modeling framework for detailed tracking of stratified health outcomes"</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="parse_config.html">parse_config</a></code> for configuration file parsing
<code><a href="MetaRVMConfig.html">MetaRVMConfig</a></code> for configuration object class
<code><a href="MetaRVMResults.html">MetaRVMResults</a></code> for results object and analysis methods
<code><a href="format_metarvm_output.html">format_metarvm_output</a></code> for output formatting details
<code><a href="meta_sim.html">meta_sim</a></code> for the underlying ODE simulation engine</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Arindam Fadikar, Charles Macal, Ignacio Martinez-Moyano, Jonathan Ozik</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic usage with YAML configuration file</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">metaRVM</span><span class="op">(</span><span class="st">"path/to/config.yaml"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print summary</span></span></span>
<span class="r-in"><span><span class="va">results</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access formatted data directly</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Method chaining for analysis and visualization</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="fu">summarize</span><span class="op">(</span></span></span>
<span class="r-in"><span>  group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"race"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"median"</span>, <span class="st">"quantile"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  disease_states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H"</span>, <span class="st">"D"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Subset and analyze specific populations</span></span></span>
<span class="r-in"><span><span class="va">subset_results</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">$</span><span class="fu">subset_data</span><span class="op">(</span></span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"65+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  disease_states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H"</span>, <span class="st">"D"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-03-01"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using with pre-parsed configuration</span></span></span>
<span class="r-in"><span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="parse_config.html">parse_config</a></span><span class="op">(</span><span class="st">"config.yaml"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">config_obj</span> <span class="op">&lt;-</span> <span class="va"><a href="MetaRVMConfig.html">MetaRVMConfig</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">config</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">metaRVM</span><span class="op">(</span><span class="va">config_obj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Accessing run metadata</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">run_info</span><span class="op">$</span><span class="va">n_instances</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">run_info</span><span class="op">$</span><span class="va">date_range</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arindam Fadikar, Charles Macal.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

